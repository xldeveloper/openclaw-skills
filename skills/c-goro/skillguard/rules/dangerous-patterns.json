{
  "version": "1.0.0",
  "rules": [
    {
      "id": "EXEC_CALL",
      "severity": "critical",
      "category": "code-execution",
      "title": "Dynamic code execution",
      "description": "Detects eval(), exec(), Function constructor, and similar dynamic execution patterns",
      "patterns": [
        "\\beval\\s*\\(",
        "\\bexec\\s*\\(",
        "\\bexecSync\\s*\\(",
        "\\bspawnSync\\s*\\(",
        "\\bexecFileSync\\s*\\(",
        "new\\s+Function\\s*\\(",
        "child_process",
        "\\bspawn\\s*\\(",
        "\\bexecFile\\s*\\("
      ],
      "languages": ["js", "ts", "py", "sh"],
      "weight": 30
    },
    {
      "id": "CRED_ACCESS",
      "severity": "critical",
      "category": "credential-theft",
      "title": "Credential file access",
      "description": "Detects access to known credential storage locations",
      "patterns": [
        "\\.env",
        "credentials\\.json",
        "auth-profiles\\.json",
        "api[_-]?key",
        "secret[_-]?key",
        "OPENAI_API_KEY",
        "ANTHROPIC_API_KEY",
        "BRAVE_API_KEY",
        "\\.ssh/",
        "\\.aws/",
        "\\.config/",
        "\\.openclaw/",
        "openclaw\\.json",
        "keychain",
        "wallet\\.dat",
        "seed[_-]?phrase",
        "private[_-]?key",
        "bearer\\s+token",
        "botToken",
        "authToken"
      ],
      "languages": ["*"],
      "weight": 25
    },
    {
      "id": "NETWORK_EXFIL",
      "severity": "high",
      "category": "data-exfiltration",
      "title": "Suspicious network activity",
      "description": "Detects patterns suggesting data exfiltration via network",
      "patterns": [
        "\\bfetch\\s*\\(",
        "\\bhttpx?\\.",
        "\\brequests?\\.",
        "\\baxios",
        "\\bcurl\\b",
        "\\bwget\\b",
        "\\bhttp\\.request",
        "\\bnet\\.connect",
        "webhook",
        "ngrok",
        "\\bSocket\\s*\\(",
        "\\bnslookup\\b",
        "\\bdig\\s+",
        "\\.exfil\\.",
        "\\bdns\\.resolve"
      ],
      "languages": ["*"],
      "weight": 15
    },
    {
      "id": "FS_WRITE",
      "severity": "high",
      "category": "filesystem",
      "title": "Filesystem write operations",
      "description": "Detects file write operations that could modify system or config files",
      "patterns": [
        "\\bwriteFile",
        "\\bwriteFileSync",
        "\\bappendFile",
        "\\bfs\\.write",
        "\\bfs\\.mkdir",
        "\\bfs\\.rename",
        "\\bfs\\.unlink",
        "\\bfs\\.rm",
        "open\\s*\\([^)]*['\"]w",
        "\\bshutil\\.",
        "\\bos\\.remove",
        "\\bos\\.unlink",
        "\\brmdir",
        "\\brm\\s+-rf"
      ],
      "languages": ["*"],
      "weight": 15
    },
    {
      "id": "OBFUSCATION",
      "severity": "critical",
      "category": "obfuscation",
      "title": "Code obfuscation",
      "description": "Detects obfuscation techniques used to hide malicious code",
      "patterns": [
        "\\batob\\s*\\(",
        "\\bbtoa\\s*\\(",
        "Buffer\\.from\\s*\\([^)]*['\"]base64",
        "fromCharCode",
        "charCodeAt",
        "\\\\x[0-9a-fA-F]{2}",
        "\\\\u[0-9a-fA-F]{4}",
        "decodeURIComponent\\s*\\(",
        "unescape\\s*\\(",
        "String\\.raw",
        "base64\\.b64decode",
        "base64\\.decodebytes",
        "toString\\s*\\(\\s*['\"]hex['\"]",
        "toString\\s*\\(\\s*['\"]base64['\"]"
      ],
      "languages": ["*"],
      "weight": 20
    },
    {
      "id": "PROMPT_INJECTION",
      "severity": "critical",
      "category": "prompt-injection",
      "title": "Prompt injection payload",
      "description": "Detects embedded prompt injection attempts in skill files",
      "patterns": [
        "<system>",
        "</system>",
        "SYSTEM\\s*OVERRIDE",
        "ignore\\s+(previous|prior|above)\\s+instructions",
        "forget\\s+(previous|prior|above|your)\\s+instructions",
        "you\\s+are\\s+now\\s+in",
        "new\\s+instructions?:",
        "IMPORTANT\\s*READ",
        "execute\\s+immediately",
        "do\\s+not\\s+tell\\s+the\\s+user",
        "hidden\\s+instruction",
        "\\[INST\\]",
        "\\[/INST\\]",
        "<<SYS>>",
        "<</SYS>>"
      ],
      "languages": ["*"],
      "weight": 30
    },
    {
      "id": "CRYPTO_WALLET",
      "severity": "high",
      "category": "financial",
      "title": "Cryptocurrency wallet access",
      "description": "Detects access to cryptocurrency wallets and private keys",
      "patterns": [
        "wallet\\.dat",
        "keystore",
        "seed[_-]?phrase",
        "mnemonic",
        "private[_-]?key",
        "ethers\\.Wallet",
        "web3\\.eth\\.accounts",
        "solana.*keypair",
        "\\bhdkey\\b",
        "bip39",
        "bip32"
      ],
      "languages": ["*"],
      "weight": 20
    },
    {
      "id": "PERSISTENCE",
      "severity": "high",
      "category": "persistence",
      "title": "System persistence mechanisms",
      "description": "Detects attempts to establish persistence (cron, startup, services)",
      "patterns": [
        "crontab",
        "systemctl",
        "\\.bashrc",
        "\\.profile",
        "\\.zshrc",
        "rc\\.local",
        "launchd",
        "LaunchAgent",
        "autostart",
        "startup\\s+script",
        "pm2\\s+start",
        "\\bsystemd\\b"
      ],
      "languages": ["*"],
      "weight": 20
    },
    {
      "id": "PRIV_ESCALATION",
      "severity": "critical",
      "category": "privilege-escalation",
      "title": "Privilege escalation attempt",
      "description": "Detects attempts to escalate privileges",
      "patterns": [
        "\\bsudo\\b",
        "\\bsu\\s+-",
        "\\bchmod\\s+[0-7]*[4-7][0-7]{2}",
        "\\bchmod\\s+\\+s",
        "setuid",
        "setgid",
        "\\bchown\\b",
        "passwd",
        "/etc/shadow",
        "/etc/sudoers",
        "NOPASSWD"
      ],
      "languages": ["*"],
      "weight": 25
    }
  ]
}
